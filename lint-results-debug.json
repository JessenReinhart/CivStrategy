[{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\components\\GameUI.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\components\\LoadingScreen.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\components\\MainMenu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\components\\PhaserGame.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\MainScene.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":265,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":265,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11045,11048],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11045,11048],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":369,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":369,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15156,15159],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15156,15159],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":377,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":377,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15526,15529],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15526,15529],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\BuildingManager.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":71,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":71,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2923,2926],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2923,2926],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":205,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":205,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8639,8642],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8639,8642],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":217,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":217,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9251,9254],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9251,9254],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":238,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":238,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10284,10287],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10284,10287],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":274,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":274,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11728,11731],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11728,11731],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":355,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":355,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[14478,14481],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[14478,14481],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\CullingSystem.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":76,"column":41,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":44,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2995,2998],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2995,2998],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":81,"column":30,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":81,"endColumn":33,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3285,3288],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3285,3288],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":111,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":111,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4619,4622],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4619,4622],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":118,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":118,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4969,4972],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4969,4972],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":122,"column":108,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":111,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5454,5457],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5454,5457],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":122,"column":127,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":122,"endColumn":130,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5473,5476],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5473,5476],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":125,"column":106,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":109,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5687,5690],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5687,5690],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":125,"column":124,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":125,"endColumn":127,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5705,5708],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5705,5708],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\EconomySystem.ts","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-explicit-any').","line":62,"column":13,"severity":1,"nodeType":null,"fix":{"range":[2609,2671],"text":" "}},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":248,"column":61,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":248,"endColumn":64,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12456,12459],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12456,12459],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":168,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":168,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7911,7914],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7911,7914],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":236,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":236,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11507,11510],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11507,11510],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"\r\nimport Phaser from 'phaser';\r\nimport { MainScene } from '../MainScene';\r\nimport { BuildingType, BuildingDef, UnitState, UnitType, GameStats, ResourceRates } from '../../types';\r\nimport { EVENTS } from '../../constants';\r\n\r\ninterface GameUnit extends Phaser.GameObjects.Image {\r\n    unitType: UnitType;\r\n    state: UnitState;\r\n    jobBuilding?: Phaser.GameObjects.GameObject;\r\n    path?: Phaser.Math.Vector2[];\r\n    pathStep?: number;\r\n}\r\n\r\nexport class EconomySystem {\r\n    private scene: MainScene;\r\n    private lastRates: ResourceRates = { wood: 0, food: 0, gold: 0, foodConsumption: 0 };\r\n    private lastHappinessChange: number = 0;\r\n\r\n    constructor(scene: MainScene) {\r\n        this.scene = scene;\r\n    }\r\n\r\n    public tickPopulation() {\r\n        // Only manage Player population (Owner 0)\r\n        if (this.scene.population < this.scene.maxPopulation && this.scene.happiness > 50) {\r\n            const houses = this.scene.buildings.getChildren().filter((b) =>\r\n                b.getData('def').type === BuildingType.HOUSE && b.getData('owner') === 0\r\n            ) as Phaser.GameObjects.Rectangle[];\r\n\r\n            let spawnSource = null;\r\n            if (houses.length > 0) {\r\n                spawnSource = houses[Phaser.Math.Between(0, houses.length - 1)];\r\n            } else {\r\n                const townCenters = this.scene.buildings.getChildren().filter((b) =>\r\n                    b.getData('def').type === BuildingType.TOWN_CENTER && b.getData('owner') === 0\r\n                ) as Phaser.GameObjects.Rectangle[];\r\n                if (townCenters.length > 0) spawnSource = townCenters[0];\r\n            }\r\n\r\n            if (spawnSource) {\r\n                const offsetX = Phaser.Math.Between(-30, 30);\r\n                const offsetY = Phaser.Math.Between(-30, 30);\r\n                const spawnX = spawnSource.x + (offsetX >= 0 ? 50 : -50) + offsetX;\r\n                const spawnY = spawnSource.y + (offsetY >= 0 ? 50 : -50) + offsetY;\r\n\r\n                this.scene.entityFactory.spawnUnit(UnitType.VILLAGER, spawnX, spawnY, 0);\r\n                this.scene.events.emit('message', \"A new peasant has arrived.\");\r\n            }\r\n        }\r\n    }\r\n\r\n    public assignJobs() {\r\n        const vacantBuildings = this.scene.buildings.getChildren().filter((b) => {\r\n            const def = b.getData('def') as BuildingDef;\r\n            const assignedWorker = b.getData('assignedWorker');\r\n            return def.workerNeeds && !assignedWorker;\r\n        });\r\n\r\n        const idleVillagers = this.scene.units.getChildren().filter((u) => {\r\n            const unit = u as unknown as GameUnit;\r\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n            return (unit.unitType === UnitType.VILLAGER) && (unit.state === UnitState.IDLE || unit.state === UnitState.MOVING_TO_RALLY);\r\n        }) as Phaser.GameObjects.GameObject[];\r\n\r\n        for (const building of vacantBuildings) {\r\n            if (idleVillagers.length === 0) break;\r\n\r\n            const b = building as Phaser.GameObjects.Image;\r\n            const buildingOwner = b.getData('owner');\r\n\r\n            let closestWorker: Phaser.GameObjects.GameObject | null = null;\r\n            let minDist = Number.MAX_VALUE;\r\n            let workerIndex = -1;\r\n\r\n            for (let i = 0; i < idleVillagers.length; i++) {\r\n                const u = idleVillagers[i] as Phaser.GameObjects.Image;\r\n\r\n                // STRICT OWNERSHIP CHECK: Only assign villagers to buildings of the same owner\r\n                if (u.getData('owner') !== buildingOwner) continue;\r\n\r\n                const dist = Phaser.Math.Distance.Between(b.x, b.y, u.x, u.y);\r\n                if (dist < minDist) {\r\n                    minDist = dist;\r\n                    closestWorker = u;\r\n                    workerIndex = i;\r\n                }\r\n            }\r\n\r\n            if (closestWorker) {\r\n                idleVillagers.splice(workerIndex, 1);\r\n                b.setData('assignedWorker', closestWorker);\r\n                (closestWorker as unknown as GameUnit).state = UnitState.MOVING_TO_WORK;\r\n                (closestWorker as unknown as GameUnit).jobBuilding = b;\r\n\r\n                const path = this.scene.pathfinder.findPath(new Phaser.Math.Vector2((closestWorker as unknown as GameUnit).x, (closestWorker as unknown as GameUnit).y), new Phaser.Math.Vector2(b.x, b.y));\r\n                if (path) {\r\n                    (closestWorker as unknown as GameUnit).path = path;\r\n                    (closestWorker as unknown as GameUnit).pathStep = 0;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Re-filter idle villagers to those who are still truly idle and job-less\r\n        const remainingIdle = this.scene.units.getChildren().filter((u) => {\r\n            const unit = u as unknown as GameUnit;\r\n            return unit.unitType === UnitType.VILLAGER && unit.state === UnitState.IDLE && !unit.jobBuilding;\r\n        });\r\n\r\n        if (remainingIdle.length > 0) {\r\n            const allBonfires = this.scene.buildings.getChildren().filter((b) => b.getData('def').type === BuildingType.BONFIRE) as Phaser.GameObjects.Rectangle[];\r\n\r\n            if (allBonfires.length > 0) {\r\n                remainingIdle.forEach((u) => {\r\n                    const owner = u.getData('owner');\r\n                    // Filter bonfires by OWNER\r\n                    const myBonfires = allBonfires.filter((b) => b.getData('owner') === owner);\r\n\r\n                    if (myBonfires.length > 0) {\r\n                        let closestBonfire = myBonfires[0];\r\n                        let minDistance = Number.MAX_VALUE;\r\n                        for (const bonfire of myBonfires) {\r\n                            const d = Phaser.Math.Distance.Between((u as Phaser.GameObjects.Image).x, (u as Phaser.GameObjects.Image).y, bonfire.x, bonfire.y);\r\n                            if (d < minDistance) {\r\n                                minDistance = d;\r\n                                closestBonfire = bonfire;\r\n                            }\r\n                        }\r\n                        const rallyPoint = closestBonfire;\r\n                        // Only move if far away\r\n                        if (minDistance > 100) {\r\n                            (u as unknown as GameUnit).state = UnitState.MOVING_TO_RALLY;\r\n                            const angle = Math.random() * Math.PI * 2;\r\n                            const r = Math.random() * 60 + 40;\r\n                            const destX = rallyPoint.x + Math.cos(angle) * r;\r\n                            const destY = rallyPoint.y + Math.sin(angle) * r;\r\n                            const path = this.scene.pathfinder.findPath(new Phaser.Math.Vector2((u as Phaser.GameObjects.Image).x, (u as Phaser.GameObjects.Image).y), new Phaser.Math.Vector2(destX, destY));\r\n                            if (path) {\r\n                                (u as unknown as GameUnit).path = path;\r\n                                (u as unknown as GameUnit).pathStep = 0;\r\n                            }\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n        }\r\n    }\r\n\r\n    public tickEconomy() {\r\n        const isLowHappiness = this.scene.happiness < 50;\r\n        const efficiency = isLowHappiness ? 0.5 : 1.0;\r\n        const taxGoldPerPop = this.scene.taxRate;\r\n\r\n        let foodGen = 0;\r\n        let woodGen = 0;\r\n\r\n        // Base Commerce for Player\r\n        let goldGen = Math.floor((this.scene.population * (0.5 + taxGoldPerPop)) * efficiency);\r\n\r\n        const harvestedTrees = new Set<Phaser.GameObjects.GameObject>();\r\n\r\n        this.scene.buildings.getChildren().forEach((bObj) => {\r\n            const b = bObj as Phaser.GameObjects.Image;\r\n            // STRICT OWNERSHIP CHECK: Only process PLAYER buildings for player economy\r\n            if (b.getData('owner') !== 0) return;\r\n\r\n            const def = b.getData('def') as BuildingDef;\r\n            const visual = (b as any).visual as Phaser.GameObjects.Container; // eslint-disable-line @typescript-eslint/no-explicit-any\r\n            const vacantIcon = visual.getData('vacantIcon') as Phaser.GameObjects.Text;\r\n            const noResIcon = visual.getData('noResIcon') as Phaser.GameObjects.Text;\r\n\r\n            let isWorking = true;\r\n            let productionAmount = 0;\r\n            let productionType = '';\r\n\r\n            if (def.workerNeeds) {\r\n                const worker = b.getData('assignedWorker');\r\n                if (worker && worker.state === UnitState.WORKING) {\r\n                    if (vacantIcon) vacantIcon.visible = false;\r\n                } else {\r\n                    isWorking = false;\r\n                    if (vacantIcon) vacantIcon.visible = true;\r\n                }\r\n            }\r\n\r\n            if (def.type === BuildingType.TOWN_CENTER) {\r\n                goldGen += Math.floor(2 * efficiency);\r\n                isWorking = true;\r\n            }\r\n\r\n            if (isWorking) {\r\n                if (def.type === BuildingType.FARM) {\r\n                    let gain = 5;\r\n                    const isFertile = this.scene.fertileZones.some(zone => zone.contains((b as Phaser.GameObjects.Image).x, (b as Phaser.GameObjects.Image).y));\r\n                    if (isFertile) gain = Math.floor(gain * 1.5);\r\n                    gain = Math.floor(gain * efficiency);\r\n                    foodGen += gain;\r\n                    productionAmount = gain;\r\n                    productionType = 'Food';\r\n                }\r\n\r\n                if (def.type === BuildingType.LUMBER_CAMP && def.effectRadius) {\r\n                    let treesNearby = 0;\r\n                    // Optimize: Use Spatial Partitioning\r\n                    const candidates = this.scene.treeSpatialHash.query((b as Phaser.GameObjects.Image).x, (b as Phaser.GameObjects.Image).y, def.effectRadius);\r\n\r\n                    for (const t of candidates) {\r\n                        // Cast t to Image to access x,y\r\n                        const tree = t as Phaser.GameObjects.Image;\r\n                        if (Phaser.Math.Distance.Between((b as Phaser.GameObjects.Image).x, (b as Phaser.GameObjects.Image).y, tree.x, tree.y) < def.effectRadius) {\r\n                            const isChopped = tree.getData('isChopped');\r\n                            if (!isChopped && !harvestedTrees.has(tree)) {\r\n                                treesNearby++;\r\n                                harvestedTrees.add(tree);\r\n                                if (Math.random() < 0.1) {\r\n                                    this.scene.entityFactory.updateTreeVisual(tree, true);\r\n                                    // if (this.scene.minimapSystem) this.scene.minimapSystem.refreshStaticLayer();\r\n                                    this.scene.feedbackSystem.showFloatingText(tree.x, tree.y, \"Chopped!\", \"#a0522d\");\r\n                                }\r\n\r\n                            }\r\n                        }\r\n                    }\r\n                    if (noResIcon) noResIcon.visible = (treesNearby === 0);\r\n                    let gain = Math.min(treesNearby * 2, 12);\r\n                    gain = Math.floor(gain * efficiency);\r\n                    woodGen += gain;\r\n                    if (gain > 0) {\r\n                        productionAmount = gain;\r\n                        productionType = 'Wood';\r\n                    }\r\n                }\r\n\r\n                if (def.type === BuildingType.HUNTERS_LODGE && def.effectRadius) {\r\n                    const animals = this.scene.units.getChildren().filter((u) => {\r\n                        return (u as any).unitType === UnitType.ANIMAL && Phaser.Math.Distance.Between((b as Phaser.GameObjects.Image).x, (b as Phaser.GameObjects.Image).y, (u as Phaser.GameObjects.Image).x, (u as Phaser.GameObjects.Image).y) < def.effectRadius!; // eslint-disable-line @typescript-eslint/no-explicit-any\r\n                    });\r\n                    const animalsNearby = animals.length;\r\n                    if (noResIcon) noResIcon.visible = (animalsNearby === 0);\r\n                    if (animalsNearby > 0) {\r\n                        let gain = 20;\r\n                        gain = Math.floor(gain * efficiency);\r\n                        foodGen += gain;\r\n                        productionAmount = gain;\r\n                        productionType = 'Food';\r\n                        if (Math.random() < 0.20) {\r\n                            const victim = animals[Phaser.Math.Between(0, animalsNearby - 1)];\r\n                            const victimVisual = (victim as any).visual;\r\n                            if (victimVisual) victimVisual.destroy();\r\n                            victim.destroy();\r\n                            this.scene.feedbackSystem.showFloatingText(b.x, b.y - 30, \"Depleted!\", \"#ef4444\");\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n            if (productionAmount > 0) {\r\n                this.scene.feedbackSystem.showFloatingResource((b as Phaser.GameObjects.Image).x, (b as Phaser.GameObjects.Image).y, productionAmount, productionType);\r\n            }\r\n\r\n        });\r\n\r\n        if (goldGen > 0) {\r\n            const tcs = this.scene.buildings.getChildren().filter((b) =>\r\n                b.getData('def').type === BuildingType.TOWN_CENTER && b.getData('owner') === 0\r\n            ) as Phaser.GameObjects.Rectangle[];\r\n            if (tcs.length > 0) {\r\n                this.scene.feedbackSystem.showFloatingResource(tcs[0].x, tcs[0].y, goldGen, 'Gold');\r\n            }\r\n\r\n        }\r\n\r\n        const foodConsumed = this.scene.population * 1;\r\n        this.lastRates = { wood: woodGen, food: foodGen, gold: goldGen, foodConsumption: foodConsumed };\r\n        this.scene.resources.food += foodGen;\r\n        this.scene.resources.wood += woodGen;\r\n        this.scene.resources.gold += goldGen;\r\n        this.scene.resources.food -= foodConsumed;\r\n        if (this.scene.resources.food < 0) this.scene.resources.food = 0;\r\n\r\n        let happinessChange = 0;\r\n        const isStarving = this.scene.resources.food === 0 && foodConsumed > 0;\r\n        if (isStarving) { happinessChange -= 5; } else { happinessChange += 1; }\r\n        if (this.scene.population > this.scene.maxPopulation) { happinessChange -= 2; }\r\n        const taxImpact = [1, 0, -1, -3, -6, -10];\r\n        happinessChange += (taxImpact[this.scene.taxRate] || 0);\r\n\r\n        // Count ONLY player parks\r\n        const parks = this.scene.buildings.getChildren().filter((b) =>\r\n            b.getData('def').type === BuildingType.SMALL_PARK && b.getData('owner') === 0\r\n        );\r\n        happinessChange += parks.length;\r\n\r\n        this.scene.happiness += happinessChange;\r\n        this.scene.happiness = Phaser.Math.Clamp(this.scene.happiness, 0, 100);\r\n        this.lastHappinessChange = happinessChange;\r\n        this.updateStats();\r\n    }\r\n\r\n    public updateStats() {\r\n        const remainingTreaty = Math.max(0, this.scene.treatyLength - this.scene.gameTime);\r\n\r\n        const stats: GameStats = {\r\n            population: this.scene.population,\r\n            maxPopulation: this.scene.maxPopulation,\r\n            happiness: this.scene.happiness,\r\n            happinessChange: this.lastHappinessChange,\r\n            resources: { ...this.scene.resources },\r\n            rates: this.lastRates,\r\n            taxRate: this.scene.taxRate,\r\n            mapMode: this.scene.mapMode,\r\n            peacefulMode: this.scene.peacefulMode,\r\n            treatyTimeRemaining: remainingTreaty\r\n        };\r\n        this.scene.game.events.emit(EVENTS.UPDATE_STATS, stats);\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\EnemyAISystem.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":144,"column":143,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":144,"endColumn":146,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4971,4974],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4971,4974],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\EntityFactory.ts","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from '@typescript-eslint/no-unused-vars').","line":2,"column":1,"severity":1,"nodeType":null,"fix":{"range":[2,63],"text":" "}}],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":84,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":84,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3890,3893],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3890,3893],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":91,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4326,4329],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4326,4329],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":92,"column":19,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":92,"endColumn":22,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4447,4450],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4447,4450],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":108,"column":15,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":18,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5108,5111],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5108,5111],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":120,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5813,5816],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5813,5816],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":148,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":148,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6989,6992],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6989,6992],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":149,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":149,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7087,7090],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7087,7090],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":155,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":155,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7403,7406],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7403,7406],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":156,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":156,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7508,7511],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7508,7511],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":157,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":157,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7632,7635],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7632,7635],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":163,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":163,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7989,7992],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7989,7992],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":181,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":181,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8896,8899],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8896,8899],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":193,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9679,9682],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9679,9682],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":193,"column":78,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":193,"endColumn":81,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9698,9701],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9698,9701],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":197,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10012,10015],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10012,10015],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":197,"column":65,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":197,"endColumn":68,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10031,10034],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10031,10034],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":222,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":222,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11187,11190],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11187,11190],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport Phaser from 'phaser';\r\nimport { MainScene } from '../MainScene';\r\nimport { BuildingType, UnitType, UnitState, BuildingDef, FactionType } from '../../types';\r\nimport { BUILDINGS, UNIT_STATS } from '../../constants';\r\nimport { toIso } from '../utils/iso';\r\n\r\nexport class EntityFactory {\r\n    private scene: MainScene;\r\n\r\n    constructor(scene: MainScene) {\r\n        this.scene = scene;\r\n    }\r\n\r\n    public spawnBuilding(type: BuildingType, x: number, y: number, owner: number = 0): Phaser.GameObjects.GameObject {\r\n        const def = BUILDINGS[type];\r\n        const b = this.scene.add.rectangle(x, y, def.width, def.height, 0x000000, 0);\r\n        this.scene.physics.add.existing(b, true);\r\n        b.setData('def', def);\r\n        b.setData('owner', owner);\r\n        b.setData('hp', def.maxHp);\r\n        b.setData('maxHp', def.maxHp);\r\n        this.scene.buildings.add(b);\r\n\r\n        this.scene.pathfinder.markGrid(x, y, def.width, def.height, true);\r\n\r\n        const visual = this.scene.add.container(0, 0);\r\n        const gfx = this.scene.add.graphics();\r\n        const baseColor = owner === 1 ? 0x3f3f46 : def.color; // Keep dark base for enemy buildings for contrast, or maybe subtle tint? Let's keep it but make banner colorful.\r\n        // ACTUALLY plan says \"Update the enemy banner creation to use this.scene.getFactionColor(owner)\".\r\n        // And \"Update spawnUnit to use this.scene.getFactionColor(owner)\".\r\n        // Let's stick to the plan.\r\n\r\n        let spriteUsed = false;\r\n\r\n        const setupSprite = (key: string, scaleMultiplier: number = 2.2, originY: number = 0.75) => {\r\n            if (!this.scene.textures.exists(key)) return false;\r\n            const sprite = this.scene.add.image(0, 0, key);\r\n            sprite.setOrigin(0.5, originY);\r\n            const targetWidth = def.width * scaleMultiplier;\r\n            const scale = targetWidth / sprite.width;\r\n            sprite.setScale(scale);\r\n            visual.add(sprite);\r\n            return true;\r\n        };\r\n\r\n        if (type === BuildingType.FARM) { if (setupSprite('field', 2.0, 0.5)) spriteUsed = true; }\r\n        else if (type === BuildingType.HOUSE) { if (setupSprite('house', 2.5, 0.85)) spriteUsed = true; }\r\n        else if (type === BuildingType.HUNTERS_LODGE) { if (setupSprite('lodge', 2.5, 0.75)) spriteUsed = true; }\r\n\r\n        if (!spriteUsed && owner === 0 && this.scene.faction === FactionType.ROMANS) {\r\n            if (type === BuildingType.TOWN_CENTER) { if (setupSprite('townhall', 1.5, 0.75)) spriteUsed = true; }\r\n            else if (type === BuildingType.LUMBER_CAMP) { if (setupSprite('lumber', 2.6, 0.75)) spriteUsed = true; }\r\n        }\r\n\r\n        if (!spriteUsed) {\r\n            if (type === BuildingType.BONFIRE) {\r\n                this.drawBonfire(gfx);\r\n                this.scene.tweens.add({ targets: gfx, scaleX: 1.05, scaleY: 1.05, alpha: 0.9, yoyo: true, repeat: -1, duration: 150 });\r\n            } else if (type === BuildingType.SMALL_PARK) {\r\n                this.drawPark(gfx);\r\n            } else {\r\n                this.drawIsoBuilding(gfx, def, baseColor);\r\n            }\r\n        }\r\n\r\n        if (owner === 1) {\r\n            const banner = this.scene.add.rectangle(0, -40, 16, 8, this.scene.getFactionColor(owner));\r\n            visual.add(banner);\r\n        }\r\n\r\n        if (!spriteUsed || type === BuildingType.BONFIRE || type === BuildingType.SMALL_PARK) {\r\n            const text = this.scene.add.text(0, -def.height * 0.5 - 10, def.name[0], { fontSize: '14px', color: '#ffffff' }).setOrigin(0.5);\r\n            visual.add([gfx, text]);\r\n        } else {\r\n            visual.add(gfx);\r\n        }\r\n\r\n        const hpBar = this.createHealthBar(visual, def.width, -def.height * 0.8 - 35);\r\n        visual.setData('hpBar', hpBar);\r\n\r\n        this.scene.add.existing(visual);\r\n        (b as any).visual = visual; // eslint-disable-line @typescript-eslint/no-explicit-any\r\n        const iso = toIso(x, y);\r\n        visual.setPosition(iso.x, iso.y).setDepth(iso.y);\r\n        visual.setInteractive(new Phaser.Geom.Rectangle(-def.width / 2, -def.height, def.width, def.height), Phaser.Geom.Rectangle.Contains);\r\n        visual.setData('building', b);\r\n\r\n        // Building selection method with pulsing glow effect\r\n        (b as any).setSelected = (selected: boolean) => { // eslint-disable-line @typescript-eslint/no-explicit-any\r\n            (b as any).isSelected = selected; // eslint-disable-line @typescript-eslint/no-explicit-any\r\n            const hpBar = visual.getData('hpBar') as Phaser.GameObjects.Container;\r\n            if (hpBar) hpBar.setVisible(selected || b.getData('hp') < b.getData('maxHp'));\r\n\r\n            if (selected) {\r\n                this.startGlowEffect(visual);\r\n            } else {\r\n                this.stopGlowEffect(visual);\r\n            }\r\n        };\r\n\r\n        if (owner === 0) {\r\n            if (def.populationBonus) this.scene.maxPopulation += def.populationBonus;\r\n            if (def.happinessBonus) this.scene.happiness += def.happinessBonus;\r\n        }\r\n\r\n        (b as any).takeDamage = (amount: number) => this.handleDamage(b, amount, false); // eslint-disable-line @typescript-eslint/no-explicit-any\r\n        return b;\r\n    }\r\n\r\n    public spawnUnit(type: UnitType, x: number, y: number, owner: number = 0) {\r\n        const stats = UNIT_STATS[type];\r\n        const radius = 8;\r\n        const unit = this.scene.add.circle(x, y, radius, 0x000000, 0);\r\n        this.scene.physics.add.existing(unit);\r\n        const body = unit.body as Phaser.Physics.Arcade.Body;\r\n        body.setCircle(radius);\r\n        unit.setData({ owner, unitType: type, hp: stats.maxHp, maxHp: stats.maxHp, attack: stats.attack, range: stats.range, attackSpeed: stats.attackSpeed });\r\n        (unit as any).lastAttackTime = 0; // eslint-disable-line @typescript-eslint/no-explicit-any\r\n        this.scene.units.add(unit);\r\n\r\n        // Increment population for player-owned units (but not animals)\r\n        if (owner === 0 && type !== UnitType.ANIMAL) {\r\n            this.scene.population++;\r\n        }\r\n\r\n        const visual = this.scene.add.container(0, 0);\r\n        const gfx = this.scene.add.graphics();\r\n        const primaryColor = this.scene.getFactionColor(owner);\r\n\r\n        if (type === UnitType.VILLAGER) {\r\n            gfx.fillStyle(primaryColor, 1).fillEllipse(0, 0, 10, 6);\r\n            visual.add([gfx, this.scene.add.rectangle(0, -6, 4, 8, owner === 1 ? 0x18181b : 0x7CB342), this.scene.add.circle(0, -11, 2.5, 0xffcccc)]);\r\n        } else if (type === UnitType.ANIMAL) {\r\n            gfx.fillStyle(0x795548, 1).fillEllipse(0, 0, 12, 7);\r\n            visual.add(gfx);\r\n            visual.setScale(0.8);\r\n        } else {\r\n            visual.setVisible(false);\r\n        }\r\n\r\n        if (stats.squadSize === 1) {\r\n            visual.setData('hpBar', this.createHealthBar(visual, 24, -20));\r\n        }\r\n\r\n        this.scene.add.existing(visual);\r\n        (unit as any).visual = visual; // eslint-disable-line @typescript-eslint/no-explicit-any\r\n        (unit as any).unitType = type; // eslint-disable-line @typescript-eslint/no-explicit-any\r\n\r\n        // CRITICAL FIX: Make unit visual click-able for selection/targeting\r\n        visual.setInteractive(new Phaser.Geom.Circle(0, -10, 15), Phaser.Geom.Circle.Contains);\r\n        visual.setData('unit', unit);\r\n\r\n        (unit as any).state = UnitState.IDLE; // eslint-disable-line @typescript-eslint/no-explicit-any\r\n        (unit as any).setSelected = (selected: boolean) => { // eslint-disable-line @typescript-eslint/no-explicit-any\r\n            (unit as any).isSelected = selected; // eslint-disable-line @typescript-eslint/no-explicit-any\r\n            const hpBar = visual.getData('hpBar');\r\n            if (hpBar) hpBar.setVisible(selected || unit.getData('hp') < unit.getData('maxHp'));\r\n        };\r\n\r\n        if (stats.squadSize > 1) this.scene.squadSystem.createSquad(unit, type, owner);\r\n        (unit as any).takeDamage = (amount: number) => this.handleDamage(unit, amount, true); // eslint-disable-line @typescript-eslint/no-explicit-any\r\n        return unit;\r\n    }\r\n\r\n    private createHealthBar(visual: Phaser.GameObjects.Container, width: number, y: number): Phaser.GameObjects.Container {\r\n        const bar = this.scene.add.container(0, y);\r\n        const fg = this.scene.add.rectangle(-width / 2, 0, width, 2, 0x22c55e).setOrigin(0, 0.5).setName('barFill');\r\n        bar.add([this.scene.add.rectangle(0, 0, width, 4, 0x000000), fg]);\r\n        bar.setVisible(false);\r\n        visual.add(bar);\r\n        return bar;\r\n    }\r\n\r\n    private handleDamage(entity: Phaser.GameObjects.GameObject, amount: number, isUnit: boolean) {\r\n        let hp = entity.getData('hp');\r\n        const maxHp = entity.getData('maxHp');\r\n        hp -= amount;\r\n        entity.setData('hp', hp);\r\n        const visual = (entity as any).visual as Phaser.GameObjects.Container; // eslint-disable-line @typescript-eslint/no-explicit-any\r\n        if (visual && visual.getData('hpBar')) {\r\n            const hpBar = visual.getData('hpBar') as Phaser.GameObjects.Container;\r\n            hpBar.setVisible(true);\r\n            const fill = hpBar.getByName('barFill') as Phaser.GameObjects.Rectangle;\r\n            fill.scaleX = Math.max(0, hp / maxHp);\r\n            fill.fillColor = fill.scaleX < 0.3 ? 0xef4444 : 0x22c55e;\r\n        }\r\n        if (hp <= 0) {\r\n            if (isUnit) { this.scene.squadSystem.destroySquad(entity); if (entity.getData('owner') === 0) this.scene.population--; }\r\n            else {\r\n                const def = entity.getData('def');\r\n                this.scene.pathfinder.markGrid((entity as any).x, (entity as any).y, def.width, def.height, false); // eslint-disable-line @typescript-eslint/no-explicit-any\r\n                if (entity.getData('owner') === 0 && def.populationBonus) this.scene.maxPopulation -= def.populationBonus;\r\n\r\n                // Trigger explosion effect\r\n                const iso = toIso((entity as any).x, (entity as any).y); // eslint-disable-line @typescript-eslint/no-explicit-any\r\n                this.scene.buildingManager.emitExplosionParticles(iso.x, iso.y, def.width);\r\n            }\r\n            if (visual) visual.destroy();\r\n            entity.destroy();\r\n        }\r\n    }\r\n\r\n    public spawnTree(x: number, y: number) {\r\n        // Optimization: Use single Image instead of Container + 2 Images\r\n        // VIRTUALIZATON: Do NOT create visual here. Store data for pool.\r\n        const treeBase = this.scene.add.circle(x, y, 6, 0x000000, 0);\r\n        treeBase.setVisible(false); // Invisible, logic only\r\n        this.scene.physics.add.existing(treeBase, true);\r\n        this.scene.trees.add(treeBase);\r\n        this.scene.treeSpatialHash.insert(treeBase);\r\n\r\n        // Store visual properties for later hydration\r\n        treeBase.setData('visualScale', Phaser.Math.FloatBetween(0.8, 1.1) * 0.075);\r\n        treeBase.setData('visualTexture', 'tree');\r\n        treeBase.setData('visualOriginY', 0.95);\r\n        treeBase.setData('isChopped', false);\r\n    }\r\n\r\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\r\n    public updateTreeVisual(tree: any, isChopped: boolean) {\r\n        tree.setData('isChopped', isChopped);\r\n\r\n        // Update data\r\n        if (isChopped) {\r\n            tree.setData('visualTexture', 'stump');\r\n            tree.setData('visualScale', 0.075);\r\n            tree.setData('visualOriginY', 0.5);\r\n        } else {\r\n            tree.setData('visualTexture', 'tree');\r\n            // Keep original random scale? simplified for now\r\n            tree.setData('visualOriginY', 0.95);\r\n        }\r\n\r\n        // If currently visible (has visual), update it immediately\r\n        const visual = tree.visual as Phaser.GameObjects.Image;\r\n        if (visual) {\r\n            visual.setTexture(tree.getData('visualTexture'));\r\n            visual.setScale(tree.getData('visualScale'));\r\n            visual.setOrigin(0.5, tree.getData('visualOriginY'));\r\n        }\r\n    }\r\n\r\n    public drawIsoBuilding(gfx: Phaser.GameObjects.Graphics, def: BuildingDef, color: number, alpha = 1) {\r\n        const w = def.width, h = def.height, height = Math.min(w, h) * 0.45;\r\n        const corners = [{ x: -w / 2, y: -h / 2 }, { x: w / 2, y: -h / 2 }, { x: w / 2, y: h / 2 }, { x: -w / 2, y: h / 2 }];\r\n        const isoCorners = corners.map(c => toIso(c.x, c.y));\r\n        gfx.fillStyle(color, alpha).beginPath();\r\n        gfx.moveTo(isoCorners[0].x, isoCorners[0].y - height).lineTo(isoCorners[1].x, isoCorners[1].y - height)\r\n            .lineTo(isoCorners[2].x, isoCorners[2].y - height).lineTo(isoCorners[3].x, isoCorners[3].y - height).closePath().fillPath();\r\n        gfx.fillStyle(Phaser.Display.Color.IntegerToColor(color).darken(20).color, alpha).beginPath()\r\n            .moveTo(isoCorners[2].x, isoCorners[2].y - height).lineTo(isoCorners[1].x, isoCorners[1].y - height)\r\n            .lineTo(isoCorners[1].x, isoCorners[1].y).lineTo(isoCorners[2].x, isoCorners[2].y).closePath().fillPath();\r\n    }\r\n\r\n    private drawBonfire(gfx: Phaser.GameObjects.Graphics) {\r\n        gfx.fillStyle(0x78716c).fillEllipse(0, 0, 24, 12);\r\n        gfx.fillStyle(0xf97316, 0.8).beginPath().moveTo(-6, -6).lineTo(0, -20).lineTo(6, -6).closePath().fillPath();\r\n    }\r\n\r\n    private drawPark(gfx: Phaser.GameObjects.Graphics) {\r\n        gfx.fillStyle(0x86efac).beginPath();\r\n        const pts = [toIso(-14, -14), toIso(14, -14), toIso(14, 14), toIso(-14, 14)];\r\n        gfx.moveTo(pts[0].x, pts[0].y).lineTo(pts[1].x, pts[1].y).lineTo(pts[2].x, pts[2].y).lineTo(pts[3].x, pts[3].y).closePath().fillPath();\r\n        gfx.fillStyle(0x15803d).fillCircle(0, -4, 6);\r\n    }\r\n\r\n    private startGlowEffect(visual: Phaser.GameObjects.Container) {\r\n        // Remove any existing glow\r\n        this.stopGlowEffect(visual);\r\n\r\n        // Find all sprites/images in the container and create additive overlays\r\n        const glowOverlays: Phaser.GameObjects.Image[] = [];\r\n        visual.each((child: Phaser.GameObjects.GameObject) => {\r\n            if (child instanceof Phaser.GameObjects.Image) {\r\n                // Create a duplicate sprite on top with ADD blend mode\r\n                const overlay = this.scene.add.image(child.x, child.y, child.texture.key);\r\n                overlay.setOrigin(child.originX, child.originY);\r\n                overlay.setScale(child.scaleX, child.scaleY);\r\n                overlay.setBlendMode(Phaser.BlendModes.ADD);\r\n                overlay.setAlpha(0);\r\n                visual.add(overlay);\r\n                glowOverlays.push(overlay);\r\n            }\r\n        });\r\n\r\n        if (glowOverlays.length === 0) return;\r\n\r\n        visual.setData('glowOverlays', glowOverlays);\r\n\r\n        // Create pulsing tween on the overlay alphas\r\n        const tween = this.scene.tweens.add({\r\n            targets: glowOverlays,\r\n            alpha: { from: 0, to: 0.35 },\r\n            duration: 600,\r\n            yoyo: true,\r\n            repeat: -1,\r\n            ease: 'Sine.easeInOut'\r\n        });\r\n        visual.setData('glowTween', tween);\r\n    }\r\n\r\n    private stopGlowEffect(visual: Phaser.GameObjects.Container) {\r\n        const tween = visual.getData('glowTween') as Phaser.Tweens.Tween;\r\n        if (tween) {\r\n            tween.stop();\r\n            tween.destroy();\r\n            visual.setData('glowTween', null);\r\n        }\r\n\r\n        // Destroy overlay sprites\r\n        const glowOverlays = visual.getData('glowOverlays') as Phaser.GameObjects.Image[];\r\n        if (glowOverlays) {\r\n            glowOverlays.forEach(overlay => overlay.destroy());\r\n            visual.setData('glowOverlays', null);\r\n        }\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\FeedbackSystem.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\FogOfWarSystem.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":140,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":140,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5373,5376],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5373,5376],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":153,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":153,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6044,6047],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6044,6047],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\InfiniteMapSystem.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\InputManager.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2805,2808],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2805,2808],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":106,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":106,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4480,4483],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4480,4483],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":108,"column":26,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":108,"endColumn":29,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4655,4658],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4655,4658],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":120,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":120,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5083,5086],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5083,5086],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":132,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":132,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5597,5600],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5597,5600],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":200,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":200,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8186,8189],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8186,8189],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":204,"column":44,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":204,"endColumn":47,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8475,8478],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8475,8478],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":230,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":230,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9631,9634],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9631,9634],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":233,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":233,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9855,9858],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9855,9858],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":240,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":240,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10216,10219],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10216,10219],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":240,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":240,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10240,10243],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10240,10243],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":243,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":243,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10403,10406],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10403,10406],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":243,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":243,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10427,10430],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10427,10430],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":244,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":244,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[10543,10546],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[10543,10546],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":260,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":260,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[11220,11223],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[11220,11223],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":283,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":283,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12121,12124],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12121,12124],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":292,"column":40,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":292,"endColumn":43,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12490,12493],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12490,12493],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":305,"column":43,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":305,"endColumn":46,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12908,12911],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12908,12911],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":305,"column":87,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":305,"endColumn":90,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12952,12955],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12952,12955],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":306,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":306,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[13084,13087],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[13084,13087],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\MapGenerationSystem.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\MinimapSystem.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":128,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":128,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4900,4903],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4900,4903],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":171,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":171,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[6441,6444],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[6441,6444],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":191,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":191,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7339,7342],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7339,7342],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":229,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":229,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8673,8676],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8673,8676],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":245,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":245,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9436,9439],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9436,9439],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\Pathfinder.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\SquadSystem.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":50,"column":42,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":45,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1726,1729],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1726,1729],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2624,2627],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2624,2627],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":73,"column":29,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":73,"endColumn":32,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2729,2732],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2729,2732],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":85,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":85,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3158,3161],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3158,3161],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\systems\\UnitSystem.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'UnitStats' is defined but never used. Allowed unused vars must match /^_/u.","line":4,"column":31,"nodeType":null,"messageId":"unusedVar","endLine":4,"endColumn":40},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'TILE_SIZE' is defined but never used. Allowed unused vars must match /^_/u.","line":5,"column":33,"nodeType":null,"messageId":"unusedVar","endLine":5,"endColumn":42},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":35,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":35,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1223,1226],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1223,1226],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":70,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":70,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2676,2679],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2676,2679],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement. Only these console methods are allowed: warn, error.","line":88,"column":17,"nodeType":"MemberExpression","messageId":"limited","endLine":88,"endColumn":28,"suggestions":[{"fix":{"range":[3619,3673],"text":""},"messageId":"removeConsole","data":{"propertyName":"log"},"desc":"Remove the console.log()."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement. Only these console methods are allowed: warn, error.","line":94,"column":17,"nodeType":"MemberExpression","messageId":"limited","endLine":94,"endColumn":28,"suggestions":[{"fix":{"range":[3909,3961],"text":""},"messageId":"removeConsole","data":{"propertyName":"log"},"desc":"Remove the console.log()."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":99,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":99,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4066,4069],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4066,4069],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement. Only these console methods are allowed: warn, error.","line":100,"column":13,"nodeType":"MemberExpression","messageId":"limited","endLine":100,"endColumn":24,"suggestions":[{"fix":{"range":[4094,4132],"text":""},"messageId":"removeConsole","data":{"propertyName":"log"},"desc":"Remove the console.log()."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":102,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4207,4210],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4207,4210],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement. Only these console methods are allowed: warn, error.","line":109,"column":13,"nodeType":"MemberExpression","messageId":"limited","endLine":109,"endColumn":24,"suggestions":[{"fix":{"range":[4385,4430],"text":""},"messageId":"removeConsole","data":{"propertyName":"log"},"desc":"Remove the console.log()."}]},{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'delta' is defined but never used. Allowed unused args must match /^_/u.","line":113,"column":43,"nodeType":null,"messageId":"unusedVar","endLine":113,"endColumn":48},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":115,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":115,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4636,4639],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4636,4639],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":180,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":180,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7821,7824],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7821,7824],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":181,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":181,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7858,7861],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7858,7861],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":195,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":195,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[8471,8474],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[8471,8474],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement. Only these console methods are allowed: warn, error.","line":220,"column":17,"nodeType":"MemberExpression","messageId":"limited","endLine":220,"endColumn":28,"suggestions":[{"fix":{"range":[9301,9375],"text":""},"messageId":"removeConsole","data":{"propertyName":"log"},"desc":"Remove the console.log()."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":232,"column":33,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":232,"endColumn":36,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9776,9779],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9776,9779],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":232,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":232,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[9789,9792],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[9789,9792],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"no-console","severity":1,"message":"Unexpected console statement. Only these console methods are allowed: warn, error.","line":234,"column":9,"nodeType":"MemberExpression","messageId":"limited","endLine":234,"endColumn":20,"suggestions":[{"fix":{"range":[9856,9943],"text":""},"messageId":"removeConsole","data":{"propertyName":"log"},"desc":"Remove the console.log()."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":298,"column":34,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":298,"endColumn":37,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12538,12541],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12538,12541],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":298,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":298,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[12551,12554],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[12551,12554],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":363,"column":52,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":363,"endColumn":55,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[15125,15128],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[15125,15128],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":392,"column":31,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":392,"endColumn":34,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[16387,16390],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[16387,16390],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":17,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport Phaser from 'phaser';\r\nimport { MainScene } from '../MainScene';\r\nimport { UnitType, UnitState, UnitStats } from '../../types';\r\nimport { MAP_WIDTH, MAP_HEIGHT, TILE_SIZE, UNIT_SPEED, UNIT_STATS } from '../../constants';\r\nimport { toIso } from '../utils/iso';\r\n\r\nexport class UnitSystem {\r\n    private scene: MainScene;\r\n    private pathGraphics: Phaser.GameObjects.Graphics;\r\n    private debugGraphics: Phaser.GameObjects.Graphics;\r\n\r\n    constructor(scene: MainScene) {\r\n        this.scene = scene;\r\n        this.pathGraphics = this.scene.add.graphics().setDepth(-4000);\r\n        this.debugGraphics = this.scene.add.graphics().setDepth(100000);\r\n    }\r\n\r\n    public update(time: number, delta: number) {\r\n        this.updateUnitLogic(time, delta);\r\n        this.drawUnitPaths(time);\r\n\r\n        if (this.scene.debugMode) {\r\n            this.drawDebugLines();\r\n        } else {\r\n            this.debugGraphics.clear();\r\n        }\r\n    }\r\n\r\n    public commandMove(units: Phaser.GameObjects.GameObject[], target: Phaser.Math.Vector2) {\r\n        const spacing = 15;\r\n        const formationCols = Math.ceil(Math.sqrt(units.length));\r\n\r\n        units.forEach((unitObj, index) => {\r\n            const unit = unitObj as any;\r\n            const col = index % formationCols;\r\n            const row = Math.floor(index / formationCols);\r\n            const offsetX = (col - formationCols / 2) * spacing;\r\n            const offsetY = (row - Math.ceil(units.length / formationCols) / 2) * spacing;\r\n            const unitTarget = new Phaser.Math.Vector2(target.x + offsetX, target.y + offsetY);\r\n\r\n            const path = this.scene.pathfinder.findPath(new Phaser.Math.Vector2(unit.x, unit.y), unitTarget);\r\n            if (path) {\r\n                unit.path = path;\r\n                unit.pathStep = 0;\r\n                unit.pathCreatedAt = this.scene.gameTime;\r\n                unit.state = UnitState.IDLE;\r\n                unit.target = null; // Clear combat target\r\n                unit.body.reset(unit.x, unit.y);\r\n            }\r\n        });\r\n\r\n        // Visual feedback\r\n        const iso = toIso(target.x, target.y);\r\n        const circle = this.scene.add.circle(iso.x, iso.y, 5, 0xffffff);\r\n        circle.setScale(1, 0.5);\r\n        circle.setDepth(iso.y);\r\n        this.scene.tweens.add({\r\n            targets: circle,\r\n            scaleX: 0,\r\n            scaleY: 0,\r\n            alpha: 0,\r\n            duration: 500,\r\n            onComplete: () => circle.destroy()\r\n        });\r\n    }\r\n\r\n    public commandAttack(units: Phaser.GameObjects.GameObject[], target: Phaser.GameObjects.GameObject) {\r\n        units.forEach((unitObj) => {\r\n            const unit = unitObj as any;\r\n\r\n            // --- SECURITY BLOCK ---\r\n            // If peaceful mode is active and this is an ENEMY unit, reject the attack command entirely.\r\n            if (this.scene.peacefulMode && unit.getData('owner') !== 0) {\r\n                // Flash a debug indicator if in debug mode\r\n                if (this.scene.debugMode) {\r\n                    const iso = toIso(unit.x, unit.y);\r\n                    const x = this.scene.add.text(iso.x, iso.y, \"X\", { color: '#ff0000', fontSize: '20px' });\r\n                    x.setOrigin(0.5);\r\n                    this.scene.tweens.add({ targets: x, y: iso.y - 20, alpha: 0, duration: 500, onComplete: () => x.destroy() });\r\n                }\r\n                return;\r\n            }\r\n            // ----------------------\r\n\r\n            // Only combat units attack\r\n            if ([UnitType.SOLDIER, UnitType.CAVALRY, UnitType.LEGION, UnitType.ARCHER].includes(unit.unitType)) {\r\n                console.log(`Unit ${unit.unitType} engaging target.`);\r\n                unit.target = target;\r\n                unit.state = UnitState.CHASING;\r\n                unit.path = null; // Clear old move path\r\n                unit.body.reset(unit.x, unit.y);\r\n            } else {\r\n                console.log(`Unit ${unit.unitType} CANNOT attack.`);\r\n            }\r\n        });\r\n\r\n        // Visual Feedback (Red Flash on target)\r\n        if ((target as any).visual) {\r\n            console.log(\"Flashing Target visual\");\r\n            this.scene.tweens.add({\r\n                targets: (target as any).visual,\r\n                alpha: 0.5,\r\n                yoyo: true,\r\n                duration: 100,\r\n                repeat: 2\r\n            });\r\n        } else {\r\n            console.log(\"Target has no visual to flash\");\r\n        }\r\n    }\r\n\r\n    private updateUnitLogic(time: number, delta: number) {\r\n        this.scene.units.getChildren().forEach((item: Phaser.GameObjects.GameObject) => {\r\n            const unit = item as any;\r\n            const body = unit.body as Phaser.Physics.Arcade.Body;\r\n\r\n            if (!body) return;\r\n\r\n            // Failsafe: If peaceful mode is on, force enemy combat units to stop attacking\r\n            if (this.scene.peacefulMode === true && unit.getData('owner') !== 0) {\r\n                if (unit.state === UnitState.CHASING || unit.state === UnitState.ATTACKING) {\r\n                    unit.state = UnitState.IDLE;\r\n                    unit.target = null;\r\n                    body.setVelocity(0, 0);\r\n                }\r\n            }\r\n\r\n            // Combat State Logic\r\n            if (unit.state === UnitState.CHASING || unit.state === UnitState.ATTACKING) {\r\n                this.handleCombatState(unit, time);\r\n            }\r\n            // --- ANIMAL WANDERING AI ---\r\n            else if (unit.unitType === UnitType.ANIMAL) {\r\n                if (body.velocity.length() > 0) {\r\n                    const dest = unit.getData('wanderDest') as Phaser.Math.Vector2;\r\n                    if (dest && Phaser.Math.Distance.Between(unit.x, unit.y, dest.x, dest.y) < 5) {\r\n                        body.setVelocity(0, 0);\r\n                        unit.state = UnitState.IDLE;\r\n                    }\r\n                } else if (Math.random() < 0.005) {\r\n                    const wanderRadius = 100;\r\n                    const angle = Math.random() * Math.PI * 2;\r\n                    const dist = Math.random() * wanderRadius;\r\n                    const tx = Phaser.Math.Clamp(unit.x + Math.cos(angle) * dist, 50, MAP_WIDTH - 50);\r\n                    const ty = Phaser.Math.Clamp(unit.y + Math.sin(angle) * dist, 50, MAP_HEIGHT - 50);\r\n\r\n                    unit.setData('wanderDest', new Phaser.Math.Vector2(tx, ty));\r\n                    this.scene.physics.moveTo(unit, tx, ty, 20);\r\n                    unit.state = UnitState.WANDERING;\r\n                }\r\n            }\r\n            // --- PATH FOLLOWING ---\r\n            else if (unit.path && unit.path.length > 0) {\r\n                if (unit.pathStep >= unit.path.length) {\r\n                    body.setVelocity(0, 0);\r\n                    unit.path = null;\r\n                    if (unit.unitType === UnitType.VILLAGER) {\r\n                        if (unit.state === UnitState.MOVING_TO_WORK) unit.state = UnitState.WORKING;\r\n                        else if (unit.state === UnitState.MOVING_TO_RALLY) unit.state = UnitState.IDLE;\r\n                    }\r\n                    return;\r\n                }\r\n                const nextPoint = unit.path[unit.pathStep];\r\n                const dist = Phaser.Math.Distance.Between(unit.x, unit.y, nextPoint.x, nextPoint.y);\r\n                const speed = UNIT_SPEED[unit.unitType as UnitType] || 100;\r\n\r\n                if (dist < 4) {\r\n                    unit.pathStep++;\r\n                } else {\r\n                    this.scene.physics.moveTo(unit, nextPoint.x, nextPoint.y, speed);\r\n                }\r\n            } else {\r\n                if (body.velocity.length() > 0) body.setVelocity(0, 0);\r\n            }\r\n        });\r\n\r\n        // Separation\r\n        this.scene.physics.overlap(this.scene.units, this.scene.units, (obj1, obj2) => {\r\n            const u1 = obj1 as any;\r\n            const u2 = obj2 as any;\r\n            if (u1 === u2) return;\r\n            const dist = Phaser.Math.Distance.Between(u1.x, u1.y, u2.x, u2.y);\r\n            if (dist < 18) {\r\n                const angle = Phaser.Math.Angle.Between(u2.x, u2.y, u1.x, u1.y);\r\n                const force = (18 - dist) * 1.5;\r\n                u1.body.velocity.x += Math.cos(angle) * force;\r\n                u1.body.velocity.y += Math.sin(angle) * force;\r\n                u2.body.velocity.x -= Math.cos(angle) * force;\r\n                u2.body.velocity.y -= Math.sin(angle) * force;\r\n            }\r\n        });\r\n    }\r\n\r\n    private handleCombatState(unit: any, time: number) {\r\n        const target = unit.target;\r\n\r\n        // Target dead or destroyed\r\n        if (!target || !target.scene) {\r\n            unit.state = UnitState.IDLE;\r\n            unit.target = null;\r\n            unit.body.setVelocity(0, 0);\r\n            return;\r\n        }\r\n\r\n        const dist = Phaser.Math.Distance.Between(unit.x, unit.y, target.x, target.y);\r\n        const range = unit.getData('range') || 40;\r\n        const attackSpeed = unit.getData('attackSpeed') || 1000;\r\n\r\n        // Attack Logic\r\n        if (dist <= range) {\r\n            unit.body.setVelocity(0, 0);\r\n            unit.state = UnitState.ATTACKING;\r\n\r\n            const now = time;\r\n            const last = unit.lastAttackTime || 0;\r\n            const cooldown = attackSpeed;\r\n\r\n            if (now - last > cooldown) {\r\n                console.log(`Attack Ready! Time: ${now}, Last: ${last}, CD: ${cooldown}`);\r\n                unit.lastAttackTime = now;\r\n                this.performAttack(unit, target);\r\n            }\r\n        } else {\r\n            // Chase Logic\r\n            unit.state = UnitState.CHASING;\r\n            const speed = UNIT_SPEED[unit.unitType as UnitType] || 100;\r\n            this.scene.physics.moveTo(unit, target.x, target.y, speed);\r\n        }\r\n    }\r\n\r\n    private performAttack(unit: any, target: any) {\r\n        const dmg = unit.getData('attack') || 10;\r\n        console.log(`PerformAttack: ${unit.unitType} -> Target (HP: ${target.getData('hp')})`);\r\n\r\n        if (unit.unitType === UnitType.ARCHER) {\r\n            // VOLLEY LOGIC\r\n            // Calculate active soldiers based on HP ratio\r\n            const maxHp = unit.getData('maxHp');\r\n            const currentHp = unit.getData('hp');\r\n            const squadSize = UNIT_STATS[UnitType.ARCHER].squadSize;\r\n\r\n            // At least 1 arrow, up to squadSize\r\n            const arrowCount = Math.max(1, Math.ceil((currentHp / maxHp) * squadSize));\r\n            const damagePerArrow = dmg / arrowCount;\r\n\r\n            for (let i = 0; i < arrowCount; i++) {\r\n                // Randomize delay for loose volley feel (0-300ms)\r\n                const delay = Phaser.Math.Between(0, 300);\r\n\r\n                // Add minor random offset to target position for visual variety\r\n                const spread = 15;\r\n                const targetVaried = {\r\n                    x: target.x + Phaser.Math.Between(-spread, spread),\r\n                    y: target.y + Phaser.Math.Between(-spread, spread),\r\n                    scene: target.scene, // Duck-type validity check\r\n                    takeDamage: (amt: number) => { if (target && target.takeDamage) target.takeDamage(amt); }\r\n                };\r\n\r\n                this.scene.time.delayedCall(delay, () => {\r\n                    if (unit.scene && target.scene) { // Validity check\r\n                        this.fireProjectile(unit, targetVaried, damagePerArrow);\r\n                    }\r\n                });\r\n            }\r\n\r\n        } else {\r\n            // Melee Lunge visual\r\n            const visual = unit.visual;\r\n            if (visual) {\r\n                const angle = Phaser.Math.Angle.Between(unit.x, unit.y, target.x, target.y);\r\n                const ox = visual.x;\r\n                const oy = visual.y;\r\n                const lungeX = ox + Math.cos(angle) * 10;\r\n                const lungeY = oy + Math.sin(angle) * 5; // Iso squash\r\n\r\n                this.scene.tweens.add({\r\n                    targets: visual,\r\n                    x: lungeX,\r\n                    y: lungeY,\r\n                    duration: 100,\r\n                    yoyo: true,\r\n                    onComplete: () => {\r\n                        // Reset position exactly to avoid drift\r\n                        const iso = toIso(unit.x, unit.y);\r\n                        visual.setPosition(iso.x, iso.y);\r\n                    }\r\n                });\r\n            }\r\n\r\n            // Apply Damage Immediately (Melee)\r\n            if (target.takeDamage) {\r\n                target.takeDamage(dmg);\r\n            }\r\n        }\r\n    }\r\n\r\n    private fireProjectile(unit: any, target: any, dmg: number) {\r\n        const startIso = toIso(unit.x, unit.y);\r\n        const endIso = toIso(target.x, target.y);\r\n\r\n        // Visual: Arrow (WHITE)\r\n        const arrow = this.scene.add.rectangle(startIso.x, startIso.y - 20, 10, 1, 0xffffff);\r\n        arrow.setDepth(startIso.y + 100);\r\n\r\n        // Visual: Trail Effect (WHITE, LONGER)\r\n        const emitter = this.scene.add.particles(0, 0, 'white_flare', {\r\n            speed: 0,\r\n            scale: { start: 0.2, end: 0 },\r\n            alpha: { start: 0.8, end: 0 },\r\n            lifespan: 500, // Longer trail\r\n            tint: 0xffffff, // White trail\r\n            blendMode: 'ADD',\r\n            frequency: 10,\r\n            follow: arrow\r\n        });\r\n        emitter.setDepth(Number.MAX_VALUE - 100);\r\n\r\n        // Parabolic arc simulation\r\n        // We tween X and Y linearly for ground movement\r\n        // We use a custom update or a separate tween for 'height' to simulate arc\r\n\r\n        // Simple linear movement for now, with a \"height\" offset curve?\r\n        // Actually, just standard Phaser tween with a custom onUpdate is easy.\r\n\r\n        const midX = (startIso.x + endIso.x) / 2;\r\n        const midY = (startIso.y + endIso.y) / 2 - 50; // Arc peak control point\r\n\r\n        // Or we can use a Quadratic Bezier curve\r\n        const curve = new Phaser.Curves.QuadraticBezier(\r\n            new Phaser.Math.Vector2(startIso.x, startIso.y - 15),\r\n            new Phaser.Math.Vector2(midX, midY - 50), // Peak\r\n            new Phaser.Math.Vector2(endIso.x, endIso.y - 10)\r\n        );\r\n\r\n        const projectileObj = { t: 0, vec: new Phaser.Math.Vector2() };\r\n\r\n        this.scene.tweens.add({\r\n            targets: projectileObj,\r\n            t: 1,\r\n            duration: 800, // Slower flight (was 400)\r\n            onUpdate: () => {\r\n                curve.getPoint(projectileObj.t, projectileObj.vec);\r\n                arrow.setPosition(projectileObj.vec.x, projectileObj.vec.y);\r\n\r\n                // Orient arrow along tangent\r\n                const tangent = curve.getTangent(projectileObj.t);\r\n                arrow.setRotation(tangent.angle());\r\n            },\r\n            onComplete: () => {\r\n                arrow.destroy();\r\n                emitter.destroy();\r\n                // Check if target is still valid before damaging\r\n                if (target.takeDamage) {\r\n                    target.takeDamage(dmg);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    private drawDebugLines() {\r\n        this.debugGraphics.clear();\r\n        this.scene.units.getChildren().forEach((u: any) => {\r\n            const startIso = toIso(u.x, u.y);\r\n\r\n            // Draw Target Lines (Combat)\r\n            if (u.target && u.target.scene) {\r\n                const endIso = toIso(u.target.x, u.target.y);\r\n                this.debugGraphics.lineStyle(2, 0xff0000, 0.7);\r\n                this.debugGraphics.beginPath();\r\n                this.debugGraphics.moveTo(startIso.x, startIso.y);\r\n                this.debugGraphics.lineTo(endIso.x, endIso.y);\r\n                this.debugGraphics.strokePath();\r\n            }\r\n\r\n            // Draw Path Lines (Movement)\r\n            if (u.path && u.path.length > 0) {\r\n                const dest = u.path[u.path.length - 1];\r\n                const endIso = toIso(dest.x, dest.y);\r\n                this.debugGraphics.lineStyle(1, 0xffffff, 0.5);\r\n                this.debugGraphics.beginPath();\r\n                this.debugGraphics.moveTo(startIso.x, startIso.y);\r\n                this.debugGraphics.lineTo(endIso.x, endIso.y);\r\n                this.debugGraphics.strokePath();\r\n            }\r\n        });\r\n    }\r\n\r\n    private drawUnitPaths(time: number) {\r\n        this.pathGraphics.clear();\r\n        this.scene.units.getChildren().forEach((uObj: Phaser.GameObjects.GameObject) => {\r\n            const u = uObj as any;\r\n            const isSelectable = [UnitType.SOLDIER, UnitType.CAVALRY, UnitType.LEGION, UnitType.ARCHER].includes(u.unitType);\r\n\r\n            if (isSelectable && u.path && u.pathCreatedAt) {\r\n                const age = time - u.pathCreatedAt;\r\n                const fadeDuration = 1500;\r\n                if (age < fadeDuration) {\r\n                    const alpha = Phaser.Math.Clamp(1 - (age / fadeDuration), 0, 1);\r\n                    if (u.path.length > u.pathStep) {\r\n                        this.pathGraphics.beginPath();\r\n                        const startIso = toIso(u.x, u.y);\r\n                        this.pathGraphics.moveTo(startIso.x, startIso.y);\r\n                        for (let i = u.pathStep; i < u.path.length; i++) {\r\n                            const pt = u.path[i];\r\n                            const iso = toIso(pt.x, pt.y);\r\n                            this.pathGraphics.lineTo(iso.x, iso.y);\r\n                        }\r\n                        this.pathGraphics.lineStyle(2, 0xffffff, alpha);\r\n                        this.pathGraphics.strokePath();\r\n                        this.pathGraphics.lineStyle(6, 0xffffff, alpha * 0.3);\r\n                        this.pathGraphics.strokePath();\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\utils\\SpatialHash.ts","messages":[{"ruleId":"@typescript-eslint/no-unused-vars","severity":2,"message":"'Phaser' is defined but never used. Allowed unused vars must match /^_/u.","line":2,"column":8,"nodeType":null,"messageId":"unusedVar","endLine":2,"endColumn":14},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":6,"column":38,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":6,"endColumn":41,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[130,133],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[130,133],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[476,479],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[476,479],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[759,762],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[759,762],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1073,1076],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1073,1076],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":48,"column":57,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":48,"endColumn":60,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1372,1375],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1372,1375],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]},{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":49,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":49,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1404,1407],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1404,1407],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":7,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"\r\nimport Phaser from 'phaser';\r\n\r\nexport class SpatialHash {\r\n    private cellSize: number;\r\n    private buckets: Map<string, Set<any>>;\r\n\r\n    constructor(cellSize: number) {\r\n        this.cellSize = cellSize;\r\n        this.buckets = new Map();\r\n    }\r\n\r\n    private getKey(x: number, y: number): string {\r\n        const cx = Math.floor(x / this.cellSize);\r\n        const cy = Math.floor(y / this.cellSize);\r\n        return `${cx},${cy}`;\r\n    }\r\n\r\n    public insert(entity: any) {\r\n        const key = this.getKey(entity.x, entity.y);\r\n        if (!this.buckets.has(key)) {\r\n            this.buckets.set(key, new Set());\r\n        }\r\n        this.buckets.get(key)!.add(entity);\r\n        entity.setData('spatialKey', key);\r\n    }\r\n\r\n    public remove(entity: any) {\r\n        const key = entity.getData('spatialKey');\r\n        if (key && this.buckets.has(key)) {\r\n            this.buckets.get(key)!.delete(entity);\r\n            if (this.buckets.get(key)!.size === 0) {\r\n                this.buckets.delete(key);\r\n            }\r\n        }\r\n    }\r\n\r\n    public update(entity: any) {\r\n        const oldKey = entity.getData('spatialKey');\r\n        const newKey = this.getKey(entity.x, entity.y);\r\n\r\n        if (oldKey !== newKey) {\r\n            this.remove(entity);\r\n            this.insert(entity);\r\n        }\r\n    }\r\n\r\n    public query(x: number, y: number, radius: number): any[] {\r\n        const results: any[] = [];\r\n        const checkedKeys = new Set<string>();\r\n\r\n        // Calculate range of cells to check\r\n        const startX = Math.floor((x - radius) / this.cellSize);\r\n        const endX = Math.floor((x + radius) / this.cellSize);\r\n        const startY = Math.floor((y - radius) / this.cellSize);\r\n        const endY = Math.floor((y + radius) / this.cellSize);\r\n\r\n        for (let cx = startX; cx <= endX; cx++) {\r\n            for (let cy = startY; cy <= endY; cy++) {\r\n                const key = `${cx},${cy}`;\r\n                if (checkedKeys.has(key)) continue;\r\n                checkedKeys.add(key);\r\n\r\n                const bucket = this.buckets.get(key);\r\n                if (bucket) {\r\n                    bucket.forEach(entity => {\r\n                        // Rough check first? No, just return candidates\r\n                        results.push(entity);\r\n                    });\r\n                }\r\n            }\r\n        }\r\n\r\n        return results;\r\n    }\r\n}\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\game\\utils\\iso.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\LGSM228\\CivStrategy\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]